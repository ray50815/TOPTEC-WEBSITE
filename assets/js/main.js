const translations = {
  'zh-Hant': {
    nav: {
      brand: 'TOPTEC GLOBAL 頂科環球',
      home: '首頁',
      about: '關於我們',
      services: '產品與服務',
      solutions: '產業解決方案',
      cases: '成功案例',
      contactMenu: '聯絡我們',
      contactCta: '立即洽詢'
    },
    home: {
      hero: {
        eyebrow: '頂尖科技 · 全球觸達',
        title: '以信任驅動的全球科技採購',
        subtitle:
          '我們串聯創新企業與關鍵零組件，確保每一次交付都符合國際品質、法規與時效標準。',
        primaryCta: '了解產業解決方案',
        secondaryCta: '查看產品與服務',
        stat1Value: '20+',
        stat1Label: '年供應鏈經驗',
        stat2Value: '500+',
        stat2Label: '全球製造夥伴',
        stat3Value: '72h',
        stat3Label: '緊急需求72小時回覆',
        stat4Value: 'ISO',
        stat4Label: '國際品質管理體系'
      },
      advantages: {
        title: '為何國際客戶信賴 Toptec Global',
        subtitle: '從精密電子到關鍵工程零件，我們以可追溯的品質、透明的採購與可靠交付支援每項專案。',
        card1Title: '全球採購網絡',
        card1Text: '橫跨亞洲、歐洲與北美的節點提供韌性供應鏈與具競爭力的交期，滿足複雜BOM需求。',
        card2Title: '嚴格品質治理',
        card2Text: '多層檢驗、完整追溯與ISO規範流程確保每批貨物，尤其適用於受監管產業。',
        card3Title: '快速交付承諾',
        card3Text: '專責物流團隊統籌優先出貨、保稅倉儲與即時庫存，讓產線無縫運轉。',
        card4Title: '夥伴式協作',
        card4Text: '專家團隊與您共同規劃採購藍圖，從開發到量產同步滿足技術、法規與成本需求。'
      },
      trust: {
        title: '獲得120+高科技企業共同選擇',
        subtitle: '半導體、航太、精密工程與EMS龍頭一致認可的合作夥伴。',
        badge1: 'ISO 9001:2015',
        badge2: 'AS9120 準備就緒',
        badge3: '全球合格供應商',
        badge4: '新加坡製造業聯合會會員'
      },
      services: {
        title: '為全球製造打造的一站式服務',
        subtitle: '以採購智慧、工程支援與物流協同，加速您的產品上市歷程。',
        card1Title: '零組件通路',
        card1Text: '提供半導體、被動元件、互連與機電模組，皆經嚴格審核的製造商供應。',
        card1Cta: '瀏覽產品組合',
        card2Title: '技術採購顧問',
        card2Text: '跨領域工程師協助交叉比對、壽命風險控管與認證文件準備。',
        card2Cta: '探索客製方案',
        card3Title: '供應鏈執行',
        card3Text: '整合物流、保稅倉與VMI服務，確保關鍵產線持續運作。',
        card3Cta: '與專家洽談'
      },
      testimonial: {
        quote1: '「Toptec Global 成為我們最值得信賴的採購夥伴，他們的主動溝通與快速交貨大幅降低產線停機。」',
        cite1: '供應鏈總監｜國際汽車電子領導廠',
        quote2: '「從原型驗證到全球量產，他們提供工程洞察與物流協調，支援每個重要里程碑。」',
        cite2: '研發主管｜工業自動化創新企業'
      },
      cta: {
        title: '準備強化您的供應鏈嗎？',
        subtitle: '聯繫我們的專家，獲得量身訂製的採購策略。',
        button: '預約諮詢'
      }
    },
    footer: {
      brand: 'TOPTEC GLOBAL 頂科環球',
      tagline: '頂尖科技．全球觸達 —— 以無懈可擊的品質與可靠性交付關鍵零組件。',
      linksTitle: '公司資訊',
      about: '關於我們',
      services: '產品與服務',
      solutions: '產業解決方案',
      cases: '成功案例',
      contact: '聯絡我們',
      resourcesTitle: '資源中心',
      resource1: '供應商資格審查流程',
      resource2: '永續發展承諾',
      resource3: '法規與認證',
      resource4: '最新消息與洞察',
      newsletterTitle: '掌握最新資訊',
      newsletterText: '訂閱產業情報與零件供應更新。',
      newsletterLabel: '電子郵件',
      newsletterPlaceholder: '請輸入商務電子郵件',
      newsletterCta: '訂閱',
      copy: '© 2024 TOPTEC GLOBAL PTE. LTD. 版權所有。',
      privacy: '隱私政策',
      terms: '使用條款'
    },
    about: {
      hero: {
        eyebrow: '我們的故事',
        title: '立足新加坡，放眼全球供應鏈',
        subtitle:
          '源自東南亞創新樞紐，Toptec Global 結合在地敏捷與全球資源，為先進製造打造韌性採購策略。',
        cta: '與專家會面'
      },
      story: {
        title: '使命與願景',
        subtitle: '我們致力成為電子、精密工程與工業創新者最值得信賴的採購夥伴。',
        missionTitle: '使命',
        missionText: '以誠信交付頂尖科技零組件，協助合作夥伴確保營運連續、產品卓越與市場領先。',
        visionTitle: '願景',
        visionText: '打造跨境協作的供應生態系，讓製造商、工程師與供應商無縫合作、加速創新。'
      },
      timeline: {
        title: '持續精進的重要里程碑',
        subtitle: '從策略合作到國際認證，見證我們長期陪伴客戶成長的腳步。',
        year1: '2010',
        title1: '在新加坡成立 Toptec Global',
        text1: '專注支援電子製造商，敏捷處理難尋的半導體與被動元件需求。',
        year2: '2014',
        title2: '拓展精密工程解決方案',
        text2: '與歐洲、日本OEM合作，提供高精度機電模組與客製組件。',
        year3: '2018',
        title3: '取得 ISO 9001:2015 認證',
        text3: '建置完善品質管理體系，導入檢驗實驗室與供應商稽核機制。',
        year4: '2022',
        title4: '成立全球物流控管中心',
        text4: '導入24/7供應鏈監控、保稅倉儲與預測性庫存計畫，服務跨境生產專案。'
      },
      team: {
        title: '深耕工程領域的專業團隊',
        subtitle: '領導團隊橫跨電子通路、製造工程與供應鏈策略等領域。',
        point1: '<strong>創辦人兼執行長 Adrian Lim：</strong> 超過20年協助頂尖EMS與OEM推動採購轉型。',
        point2: '<strong>營運長 Janice Wong：</strong> 曾任精密工程龍頭營運主管，專長於合規與品質治理。',
        point3: '<strong>技術長 Kenji Sato：</strong> 擁有嵌入式系統專利，為客戶提供元件生命週期與風險管理建議。'
      },
      certifications: {
        title: '認證與專業資格',
        subtitle: '展現我們對品質、安全與負責任採購的承諾。',
        badge1: 'ISO 9001:2015 品質管理',
        badge2: 'ISO 14001 環境管理',
        badge3: '新加坡製造業聯合會會員',
        badge4: 'TRACE 反貪腐合規',
        badge5: 'BizSAFE Level 3'
      }
    },
    services: {
      hero: {
        eyebrow: '我們的交付',
        title: '完整覆蓋零件採購與生命週期支援',
        subtitle: '專業團隊負責零件驗證、供應商績效與物流協調，讓您專注產品創新。',
        ctaPrimary: '瀏覽產品分類',
        ctaSecondary: '申請專案諮詢'
      },
      products: {
        title: '產品分類',
        subtitle: '透過嚴格稽核與可追溯流程，取得多元電子與機電零件。',
        card1Title: '半導體與IC',
        card1Text: '提供MCU、ASIC、FPGA與記憶體，並監控產品生命週期。',
        card2Title: '被動元件',
        card2Text: '電容、電阻、電感與濾波器，具備PPAP與批次測試資料。',
        card3Title: '互連與線纜系統',
        card3Text: '客製線束、同軸、光纖與連接器，適用嚴苛環境。',
        card4Title: '機電模組',
        card4Text: '馬達、致動器、感測器與精密模組，符合車用與航太規範。',
        card5Title: '客製與停產料件',
        card5Text: '支援停產元件查找、最後採購與替代料件設計。',
        card6Title: '物流與配套',
        card6Text: '整合配套組裝、保稅倉儲與及時交貨的安全物流網絡。'
      },
      services: {
        title: '整合服務支柱',
        subtitle: '結合市場情報、工程專業與數位工具，解決各階段採購挑戰。',
        card1Title: '供應情報',
        card1Text: '預判市場變動、價格波動與配額風險，提前調整生產計畫。',
        card2Title: '品質實驗室',
        card2Text: '內建電性測試、X-Ray與功能驗證，配合防偽與追溯報告。',
        card3Title: '供應商管理',
        card3Text: '供應商導入、評比分級與共同商務規劃，維持一致標準。',
        card4Title: '工程協作',
        card4Text: '提供DFS工作坊、料件交叉比對與快速打樣支援。'
      },
      process: {
        title: '合作流程',
        subtitle: '透明的節點，從需求提出到準時交付皆有依據。',
        step1Title: '需求與規格',
        step1Text: '專屬窗口解析BOM、合規要求與交期目標，建立採購規劃。',
        step2Title: '策略報價',
        step2Text: '多供應商方案列出交期、價格與文件，協助精準決策。',
        step3Title: '訂單執行',
        step3Text: '掌控採購、檢驗與物流節點，確保零件準時到位。',
        step4Title: '售後維運',
        step4Text: '持續檢討績效、備料與工程支援，強化長期韌性。'
      },
      assurance: {
        title: '品質保證承諾',
        point1: '符合 ISO 9001 與客戶規範的認證流程。',
        point2: '全方位防偽計畫與全球供應商稽核。',
        point3: '涵蓋 REACH、RoHS 與 ITAR 的合規管理。'
      },
      logistics: {
        title: '供應鏈能力',
        point1: '新加坡、檳城、深圳與鹿特丹據點，提供全球配送。',
        point2: '安全保稅倉與即時可視化系統。',
        point3: '彈性運輸方案，含急件空運與整櫃海運。'
      },
      cta: {
        title: '需要專屬的採購方案？',
        subtitle: '告訴我們您的需求，顧問將在一個工作天內回覆。',
        button: '立即洽談'
      }
    },
    solutions: {
      hero: {
        eyebrow: '產業專長',
        title: '為關鍵產業量身打造的採購策略',
        subtitle: '結合產業洞察與敏捷執行，解決缺料、合規與上市速度等挑戰。',
        ctaPrimary: '瀏覽產業方案',
        ctaSecondary: '與顧問諮詢'
      },
      industries: {
        title: '產業方案',
        subtitle: '每套方案皆針對特定痛點與成果設計，由專責團隊執行。',
        card1Title: '半導體製造',
        card1Pain: '痛點：需求波動大且需符合先進製程與封裝標準。',
        card1Solution: '方案：多元供應策略、裸晶檢測與保稅庫存支援高混線體。',
        card1Result: '成果：停線風險下降35%，物料成本趨於穩定。',
        card2Title: '航太與國防',
        card2Pain: '痛點：零件需符合ITAR、AS9120與完整追溯要求。',
        card2Solution: '方案：嚴格供應商導入、序號化文件與品質實驗室提供合規證明。',
        card2Result: '成果：採購週期縮短28%，順利通過安全稽核。',
        card3Title: '汽車電子',
        card3Pain: '痛點：需求激增且須符合PPAP之安全關鍵零件。',
        card3Solution: '方案：分層供應夥伴、APQP品質計畫與區域備料確保供應。',
        card3Result: '成果：準時交付率提升至98%，加速新車型導入。',
        card4Title: '工業自動化',
        card4Pain: '痛點：快速迭代需要彈性採購與技術藍圖。',
        card4Solution: '方案：工程協作工作坊、替代料件認證與敏捷物流支援升級。',
        card4Result: '成果：原型交期縮短40%，維修庫存更精準。',
        card5Title: '醫療科技',
        card5Pain: '痛點：嚴格法規監管並需完整追溯。',
        card5Solution: '方案：符合GMP的文件、環境測試與合規報告。',
        card5Result: '成果：加速市場核准並降低產品召回風險。',
        card6Title: '海事與能源',
        card6Pain: '痛點：環境嚴苛且跨境法規複雜。',
        card6Solution: '方案：採購耐候零件、耐蝕組件與符合規範的跨境物流。',
        card6Result: '成果：提升設備可用率並優化船隊維保規劃。'
      },
      methodology: {
        title: '方案方法論',
        point1: '與工程規格共創供應劇本。',
        point2: '納入供應風險評估與合規節點。',
        point3: '使用數據儀表板提供高層視覺化。'
      },
      value: {
        title: '價值實現',
        point1: '以料件藍圖縮短設計至採購時間。',
        point2: '透過需求整合與預測規劃降低總成本。',
        point3: '以可稽核文件強化合規體質。'
      },
      faq: {
        title: '常見問題',
        subtitle: '回覆採購與工程團隊最常詢問的合作疑問。',
        q1: '你們如何驗證零件真偽？',
        a1: '每批貨皆執行供應商追溯、X-Ray與必要時的解封膠檢測，並提供存於數位系統的符合證明。',
        q2: '國際運輸通常需要多久？',
        a2: '標準交期約5至10個工作天，急件可透過優先物流通道於72小時內出貨。',
        q3: '能否支援原型與小量生產？',
        a3: '可以，敏捷採購小組可處理小批量、工程樣品與快速打樣，並提供彈性MOQ。',
        q4: '是否協助受監管產業的合規？',
        a4: '我們維護ISO、AS與醫療相關法規文件，提供稽核支援與全程可追溯證明。'
      },
      cta: {
        title: '與我們共創下一個成功案例',
        subtitle: '與顧問合作，規劃符合產業藍圖的料件策略。',
        button: '預約策略會議'
      }
    },
    cases: {
      hero: {
        eyebrow: '成果驗證',
        title: '以合作與精準打造的成功案例',
        subtitle: '深入了解我們如何協助全球製造商在上市時間、成本與可靠度上取得突破。',
        ctaPrimary: '檢視案例',
        ctaSecondary: '洽談您的專案'
      },
      list: {
        title: '精選案例',
        subtitle: '每個專案都展現我們在複雜需求下的敏捷執行力與可衡量成效。'
      },
      case1: {
        title: '汽車電子供應鏈加速30%',
        industry: '產業：汽車電子',
        region: '地區：東南亞',
        challenge: '<strong>挑戰：</strong>「Tier-1 車廠長期缺料導致新品上市延宕。」',
        solution: '<strong>解決方案：</strong> 建立替代料件認證、保留安全庫存並啟動VMI計畫。',
        result: '<strong>成果：</strong> 交期從8週縮短至5週，年節省120萬美元。',
        client: '客戶：Helix Automotive Systems'
      },
      case2: {
        title: '穩定半導體晶圓廠營運',
        industry: '產業：半導體製造',
        region: '地區：東北亞',
        challenge: '<strong>挑戰：</strong>「特殊化學品與晶圓短缺造成突發停機。」',
        solution: '<strong>解決方案：</strong> 多元化供應、導入預測庫存分析並於廠區附近配置保稅倉。',
        result: '<strong>成果：</strong> 設備稼動率達99.2%，供應商準時交貨率提升18%。',
        client: '客戶：Orion Semicon'
      },
      case3: {
        title: '優化工業自動化維修策略',
        industry: '產業：工業自動化',
        region: '地區：歐洲',
        challenge: '<strong>挑戰：</strong>「缺乏關鍵驅動模組造成零星停機。」',
        solution: '<strong>解決方案：</strong> 整合供應商、導入預測維修備品並提供現場技術訓練。',
        result: '<strong>成果：</strong> 非預期停機降低45%，維修效率顯著提升。',
        client: '客戶：Vantage Robotics Automation'
      },
      case4: {
        title: '協助醫療設備快速量產上市',
        industry: '產業：醫療科技',
        region: '地區：北美',
        challenge: '<strong>挑戰：</strong>「須於FDA驗證時程內取得合規零件。」',
        solution: '<strong>解決方案：</strong> 協調GMP文件、環境測試與120項料件的急速物流。',
        result: '<strong>成果：</strong> 上市時程提前6週並確保完整追溯。',
        client: '客戶：Medisyn Labs'
      },
      cta: {
        title: '創造下一個成功案例',
        subtitle: '告訴我們您的目標，我們將規劃具體可衡量的藍圖。',
        button: '與 Toptec Global 合作'
      }
    },
    contact: {
      hero: {
        eyebrow: '攜手合作',
        title: '與 Toptec Global 對話',
        subtitle: '無論是零件採購、物流支援或技術諮詢，我們都將在一個工作天內回覆。'
      },
      form: {
        title: '填寫需求表單',
        subtitle: '留下需求，我們的專家將提供量身建議。若想直接聯繫，可利用右側資訊。',
        nameLabel: '姓名',
        namePlaceholder: '請輸入姓名',
        companyLabel: '公司',
        companyPlaceholder: '請輸入公司名稱',
        titleLabel: '職稱',
        titlePlaceholder: '例如 採購經理',
        emailLabel: '商務電子郵件',
        emailPlaceholder: 'name@company.com',
        phoneLabel: '電話（選填）',
        phonePlaceholder: '國碼 + 電話號碼',
        messageLabel: '您的需求',
        messagePlaceholder: '請描述需求內容',
        successMessage: '感謝您的聯繫，我們將於一個工作天內回覆。',
        submit: '送出詢問'
      },
      details: {
        title: '直接聯絡',
        text: '顧問團隊提供週一至週五 09:00–18:00（GMT+8）服務。',
        phoneLabel: '電話：',
        phoneValue: '+65 6123 4567',
        emailLabel: '電子郵件：',
        emailValue: 'hello@toptecglobal.com',
        addressLabel: '地址：',
        addressValue: '8 Marina View, #35-02 Asia Square Tower 1, Singapore 018960',
        response: '我們承諾於一個工作天內回覆每一則訊息。'
      },
      map: {
        title: '歡迎蒞臨總部'
      },
      resources: {
        title: '需要即時協助？',
        text: '瀏覽常見問題或使用即時聊天，快速掌握零件供應與物流更新。',
        cta: '查看產業方案'
      },
      cta: {
        title: '我們隨時支援您的專案',
        subtitle: '從緊急採購到長期合作，歡迎立即聯繫。',
        button: '立即來電'
      }
    },
    general: {
      newsletterSuccess: '感謝訂閱，我們將定期寄送最新情報。'
    }
  }
};

document.addEventListener('DOMContentLoaded', () => {
  const body = document.body;
  const nav = document.querySelector('nav.primary-nav');
  const toggle = document.querySelector('.mobile-toggle');
  const langButtons = document.querySelectorAll('.language-switcher button[data-lang]');
  const htmlElement = document.documentElement;
  const currentPage = body.dataset.page;

  const navLinks = nav ? nav.querySelectorAll('a[data-page]') : [];
  navLinks.forEach((link) => {
    if (link.dataset.page === currentPage) {
      link.classList.add('active');
    }
  });

  if (toggle && nav) {
    toggle.addEventListener('click', () => {
      const expanded = toggle.getAttribute('aria-expanded') === 'true';
      toggle.setAttribute('aria-expanded', String(!expanded));
      nav.classList.toggle('open');
    });

    navLinks.forEach((link) => {
      link.addEventListener('click', () => {
        nav.classList.remove('open');
        toggle.setAttribute('aria-expanded', 'false');
      });
    });
  }

  const i18nElements = document.querySelectorAll('[data-i18n]');
  const placeholderElements = document.querySelectorAll('[data-i18n-placeholder]');

  i18nElements.forEach((el) => {
    if (!el.dataset.i18nEn) {
      el.dataset.i18nEn = el.innerHTML.trim();
    }
  });

  placeholderElements.forEach((el) => {
    if (!el.dataset.i18nPlaceholderEn) {
      el.dataset.i18nPlaceholderEn = el.getAttribute('placeholder') || '';
    }
  });

  function getTranslation(lang, key) {
    const parts = key.split('.');
    let value = translations[lang];
    for (const part of parts) {
      if (!value) {
        return undefined;
      }
      value = value[part];
    }
    return typeof value === 'string' ? value : undefined;
  }

  function setLanguage(lang) {
    const targetLang = lang === 'zh-Hant' ? 'zh-Hant' : 'en';
    htmlElement.setAttribute('lang', targetLang === 'zh-Hant' ? 'zh-Hant' : 'en');
    body.dataset.lang = targetLang;

    langButtons.forEach((btn) => {
      btn.classList.toggle('active', btn.dataset.lang === targetLang);
    });

    i18nElements.forEach((el) => {
      const key = el.dataset.i18n;
      if (!key) return;
      if (targetLang === 'en') {
        el.innerHTML = el.dataset.i18nEn || el.innerHTML;
      } else {
        const translated = getTranslation(targetLang, key);
        el.innerHTML = translated || el.dataset.i18nEn || el.innerHTML;
      }
    });

    placeholderElements.forEach((el) => {
      const key = el.dataset.i18nPlaceholder;
      if (!key) return;
      if (targetLang === 'en') {
        el.setAttribute('placeholder', el.dataset.i18nPlaceholderEn || '');
      } else {
        const translated = getTranslation(targetLang, key);
        el.setAttribute('placeholder', translated || el.dataset.i18nPlaceholderEn || '');
      }
    });

    localStorage.setItem('toptec-lang', targetLang);
  }

  const savedLang = localStorage.getItem('toptec-lang') || 'en';
  setLanguage(savedLang);

  langButtons.forEach((btn) => {
    btn.addEventListener('click', () => {
      const lang = btn.dataset.lang || 'en';
      setLanguage(lang);
    });
  });

  const faqItems = document.querySelectorAll('.faq-item');
  faqItems.forEach((item) => {
    item.addEventListener('click', () => {
      item.classList.toggle('open');
    });
    item.addEventListener('keypress', (event) => {
      if (event.key === 'Enter' || event.key === ' ') {
        event.preventDefault();
        item.classList.toggle('open');
      }
    });
  });

  const testimonialSlides = document.querySelectorAll('.testimonial-slide');
  const prevBtn = document.querySelector('.testimonial-prev');
  const nextBtn = document.querySelector('.testimonial-next');
  let testimonialIndex = 0;

  function showTestimonial(index) {
    testimonialSlides.forEach((slide, idx) => {
      slide.classList.toggle('active', idx === index);
    });
  }

  if (testimonialSlides.length > 0) {
    showTestimonial(testimonialIndex);

    prevBtn?.addEventListener('click', () => {
      testimonialIndex = (testimonialIndex - 1 + testimonialSlides.length) % testimonialSlides.length;
      showTestimonial(testimonialIndex);
    });

    nextBtn?.addEventListener('click', () => {
      testimonialIndex = (testimonialIndex + 1) % testimonialSlides.length;
      showTestimonial(testimonialIndex);
    });

    setInterval(() => {
      testimonialIndex = (testimonialIndex + 1) % testimonialSlides.length;
      showTestimonial(testimonialIndex);
    }, 8000);
  }

  const contactForm = document.querySelector('#contact-form');
  if (contactForm) {
    contactForm.addEventListener('submit', (event) => {
      event.preventDefault();
      const successMessage = contactForm.querySelector('.success-message');
      contactForm.reset();
      if (successMessage) {
        successMessage.classList.add('show');
        setTimeout(() => successMessage.classList.remove('show'), 6000);
      }
    });
  }

  const newsletterForms = document.querySelectorAll('.newsletter-form');
  newsletterForms.forEach((form) => {
    form.addEventListener('submit', (event) => {
      event.preventDefault();
      form.reset();
      const lang = body.dataset.lang || 'en';
      const message =
        lang === 'zh-Hant'
          ? getTranslation('zh-Hant', 'general.newsletterSuccess') || '感謝訂閱，我們將定期寄送最新情報。'
          : 'Thank you for subscribing. Stay tuned for our updates.';
      window.alert(message);
    });
  });
});
